<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste R√°pido - Erro 500</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .status {
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            font-weight: bold;
        }
        .status.error { background: #f8d7da; color: #721c24; }
        .status.success { background: #d4edda; color: #155724; }
        .status.warning { background: #fff3cd; color: #856404; }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 5px;
            font-size: 16px;
            width: 100%;
        }
        button:hover { background: #0056b3; }
        .result {
            background: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üö® Teste R√°pido - Erro 500</h1>
        
        <div class="status error">
            <h2>‚ùå Erro 500 Detectado</h2>
            <p>Vamos diagnosticar e resolver rapidamente!</p>
        </div>
        
        <button onclick="testWebhook()">üîç Testar Webhook Agora</button>
        <button onclick="testSimpleData()">üß™ Testar Dados Simples</button>
        <button onclick="testMakeScenario()">‚öôÔ∏è Verificar Cen√°rio Make.com</button>
        
        <div id="result" class="result">Clique em um bot√£o para come√ßar o teste...</div>
        
        <div id="nextSteps" style="margin-top: 20px;"></div>
    </div>

    <script>
        const webhookUrl = 'https://hook.us2.make.com/vd3tce9oprad7vv8eg165gouw7i8j4wn';
        
        function showResult(message, type = 'info') {
            const resultDiv = document.getElementById('result');
            const timestamp = new Date().toLocaleTimeString();
            resultDiv.innerHTML += `[${timestamp}] ${message}\n`;
            resultDiv.scrollTop = resultDiv.scrollHeight;
        }
        
        function showNextSteps(steps) {
            const stepsDiv = document.getElementById('nextSteps');
            stepsDiv.innerHTML = `
                <h3>üìã Pr√≥ximos Passos:</h3>
                <ol>
                    ${steps.map(step => `<li>${step}</li>`).join('')}
                </ol>
            `;
        }
        
        async function testWebhook() {
            showResult('üîç Testando status do webhook...');
            
            try {
                const response = await fetch(webhookUrl, { 
                    method: 'GET',
                    headers: { 'Accept': 'application/json' }
                });
                
                showResult(`üìä Status: ${response.status} ${response.statusText}`);
                
                if (response.status === 200) {
                    showResult('‚úÖ Webhook est√° ativo!', 'success');
                    showNextSteps([
                        'O webhook est√° funcionando',
                        'O problema pode estar no cen√°rio',
                        'Execute o teste de dados simples'
                    ]);
                } else if (response.status === 500) {
                    showResult('‚ùå Erro 500 confirmado - Webhook com problema', 'error');
                    showNextSteps([
                        'Acesse make.com e v√° em "Scenarios"',
                        'Encontre seu cen√°rio e verifique se est√° ativo',
                        'Clique em "Run once" para testar',
                        'Verifique se h√° erros nos m√≥dulos'
                    ]);
                } else {
                    showResult(`‚ö†Ô∏è Status inesperado: ${response.status}`, 'warning');
                }
                
            } catch (error) {
                showResult(`‚ùå Erro de conex√£o: ${error.message}`, 'error');
                showNextSteps([
                    'Verifique sua conex√£o com a internet',
                    'Confirme se a URL do webhook est√° correta',
                    'Tente novamente em alguns minutos'
                ]);
            }
        }
        
        async function testSimpleData() {
            showResult('üß™ Testando com dados simples...');
            
            const simpleData = {
                executiveName: 'Teste',
                targetSegment: 'tecnologia',
                centralTheme: 'inovacao',
                contextTrigger: 'Teste simples',
                dominantEmotion: 'confianca',
                callToAction: 'contato',
                postType: 'educativo',
                depthLevel: 'basico',
                test: true
            };
            
            try {
                const response = await fetch(webhookUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(simpleData)
                });
                
                showResult(`üì• Status: ${response.status} ${response.statusText}`);
                
                const responseText = await response.text();
                
                if (response.status === 500) {
                    showResult('‚ùå Erro 500 com dados simples', 'error');
                    showResult(`Resposta: ${responseText}`);
                    showNextSteps([
                        'O problema est√° no cen√°rio do Make.com',
                        'Acesse make.com e v√° em "Executions"',
                        'Procure pela execu√ß√£o mais recente',
                        'Clique na execu√ß√£o para ver detalhes do erro',
                        'Verifique se o AI Agent est√° configurado'
                    ]);
                } else if (response.ok) {
                    showResult('‚úÖ Dados simples funcionaram!', 'success');
                    showResult(`Resposta: ${responseText}`);
                    showNextSteps([
                        'O webhook est√° funcionando',
                        'Teste agora com dados completos na landing page',
                        'Se ainda der erro, verifique os dados enviados'
                    ]);
                } else {
                    showResult(`‚ö†Ô∏è Status: ${response.status}`, 'warning');
                    showResult(`Resposta: ${responseText}`);
                }
                
            } catch (error) {
                showResult(`‚ùå Erro: ${error.message}`, 'error');
            }
        }
        
        function testMakeScenario() {
            showResult('‚öôÔ∏è Verificando cen√°rio no Make.com...');
            showResult('üìã Passos para verificar:');
            showResult('1. Acesse make.com e fa√ßa login');
            showResult('2. V√° em "Scenarios"');
            showResult('3. Encontre seu cen√°rio');
            showResult('4. Verifique se est√° ativo (toggle verde)');
            showResult('5. Clique no cen√°rio para abri-lo');
            showResult('6. Clique em "Run once" (bot√£o play)');
            showResult('7. Verifique se executa sem erro');
            
            showNextSteps([
                'Abra make.com em outra aba',
                'Siga os passos listados acima',
                'Se o cen√°rio n√£o executar, h√° um problema de configura√ß√£o',
                'Se executar mas der erro 500, verifique os m√≥dulos',
                'Verifique se o AI Agent est√° configurado corretamente'
            ]);
        }
        
        // Inicializa√ß√£o
        window.onload = function() {
            showResult('üöÄ Teste r√°pido iniciado');
            showResult(`üîó Webhook: ${webhookUrl}`);
            showResult('üí° Clique em "Testar Webhook Agora" para come√ßar');
        };
    </script>
</body>
</html> 