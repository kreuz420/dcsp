<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste - Agente I.A</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .test-section {
            background: #f5f5f5;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        .success { color: #28a745; }
        .error { color: #dc3545; }
        .warning { color: #ffc107; }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0056b3;
        }
    </style>
</head>
<body>
    <h1>üß™ Teste da Landing Page - Agente I.A</h1>
    
    <div class="test-section">
        <h2>Verifica√ß√£o de Arquivos</h2>
        <div id="fileCheck">
            <p>Verificando arquivos necess√°rios...</p>
        </div>
    </div>
    
    <div class="test-section">
        <h2>Teste de Configura√ß√£o</h2>
        <div id="configCheck">
            <p>Verificando configura√ß√µes...</p>
        </div>
    </div>
    
    <div class="test-section">
        <h2>Teste de Funcionalidades</h2>
        <button onclick="testValidation()">Testar Valida√ß√£o</button>
        <button onclick="testWebhook()">Testar Webhook</button>
        <button onclick="testCORS()">Testar CORS</button>
        <button onclick="testPostGeneration()">Testar Gera√ß√£o de Post</button>
        <div id="testResults"></div>
    </div>
    
    <div class="test-section">
        <h2>Pr√≥ximos Passos</h2>
        <ol>
            <li>Configure a URL do webhook no arquivo <code>config.js</code></li>
            <li>Teste a landing page abrindo <code>index.html</code></li>
            <li>Configure seu agente no Make.com</li>
            <li>Fa√ßa upload para um servidor web</li>
        </ol>
    </div>

    <script src="config.js"></script>
    <script>
        // Verificar arquivos
        function checkFiles() {
            const files = ['index.html', 'styles.css', 'script.js', 'config.js'];
            const results = [];
            
            files.forEach(file => {
                const link = document.createElement('link');
                link.rel = 'stylesheet';
                link.href = file;
                
                if (file.endsWith('.css')) {
                    link.onload = () => results.push(`‚úÖ ${file} carregado`);
                    link.onerror = () => results.push(`‚ùå ${file} n√£o encontrado`);
                } else {
                    results.push(`üìÑ ${file} presente`);
                }
            });
            
            document.getElementById('fileCheck').innerHTML = results.map(r => `<p>${r}</p>`).join('');
        }
        
        // Verificar configura√ß√£o
        function checkConfig() {
            const results = [];
            
            // Simular carregamento da configura√ß√£o
            setTimeout(() => {
                if (typeof LANDING_PAGE_CONFIG !== 'undefined') {
                    results.push('‚úÖ Configura√ß√£o carregada');
                    
                                    if (LANDING_PAGE_CONFIG.webhookUrl.includes('YOUR_WEBHOOK_URL_HERE')) {
                    results.push('‚ö†Ô∏è Webhook n√£o configurado');
                } else {
                    results.push('‚úÖ Webhook configurado');
                    results.push(`üîó URL: ${LANDING_PAGE_CONFIG.webhookUrl.substring(0, 50)}...`);
                }
                    
                    results.push(`‚úÖ ${LANDING_PAGE_CONFIG.options.targetSegment.length} segmentos configurados`);
                    results.push(`‚úÖ ${LANDING_PAGE_CONFIG.options.centralTheme.length} temas configurados`);
                } else {
                    results.push('‚ùå Configura√ß√£o n√£o encontrada');
                }
                
                document.getElementById('configCheck').innerHTML = results.map(r => `<p>${r}</p>`).join('');
            }, 100);
        }
        
        // Testar valida√ß√£o
        function testValidation() {
            const results = [];
            
            // Simular dados de teste
            const testData = {
                executiveName: 'Jo√£o Silva',
                targetSegment: 'tecnologia',
                centralTheme: 'inovacao',
                contextTrigger: 'Nova regulamenta√ß√£o do setor de tecnologia que afeta diretamente nossos clientes.',
                dominantEmotion: 'confianca',
                callToAction: 'contato',
                postType: 'educativo',
                depthLevel: 'intermediario'
            };
            
            // Validar dados
            const requiredFields = Object.keys(testData);
            let isValid = true;
            
            requiredFields.forEach(field => {
                if (!testData[field]) {
                    isValid = false;
                    results.push(`‚ùå Campo ${field} est√° vazio`);
                } else {
                    results.push(`‚úÖ Campo ${field} preenchido`);
                }
            });
            
            if (testData.contextTrigger.length < 10) {
                isValid = false;
                results.push('‚ùå Contexto muito curto');
            } else {
                results.push('‚úÖ Contexto com tamanho adequado');
            }
            
            results.push(isValid ? '‚úÖ Valida√ß√£o passou' : '‚ùå Valida√ß√£o falhou');
            
            document.getElementById('testResults').innerHTML = results.map(r => `<p>${r}</p>`).join('');
        }
        
        // Testar webhook
        async function testWebhook() {
            const results = [];
            
            if (typeof LANDING_PAGE_CONFIG !== 'undefined') {
                const webhookUrl = LANDING_PAGE_CONFIG.webhookUrl;
                
                if (webhookUrl.includes('YOUR_WEBHOOK_URL_HERE')) {
                    results.push('‚ö†Ô∏è Webhook n√£o configurado - configure no config.js');
                } else {
                    results.push('‚úÖ URL do webhook configurada');
                    results.push(`üîó URL: ${webhookUrl.substring(0, 50)}...`);
                    
                    // Testar conex√£o com o webhook
                    try {
                        results.push('üîÑ Testando conex√£o com o webhook...');
                        
                        const testData = {
                            executiveName: 'Teste',
                            targetSegment: 'tecnologia',
                            centralTheme: 'inovacao',
                            contextTrigger: 'Teste de conex√£o com o webhook.',
                            dominantEmotion: 'confianca',
                            callToAction: 'contato',
                            postType: 'educativo',
                            depthLevel: 'intermediario',
                            timestamp: new Date().toISOString(),
                            userAgent: navigator.userAgent,
                            test: true
                        };
                        
                        const response = await fetch(webhookUrl, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify(testData)
                        });
                        
                        if (response.ok) {
                            results.push('‚úÖ Conex√£o com webhook bem-sucedida!');
                            results.push(`üìä Status: ${response.status}`);
                            
                            try {
                                const responseData = await response.json();
                                results.push('‚úÖ Resposta recebida do webhook');
                                if (responseData.success) {
                                    results.push('‚úÖ Agente respondeu com sucesso');
                                } else {
                                    results.push('‚ö†Ô∏è Agente retornou erro');
                                }
                            } catch (e) {
                                results.push('‚ö†Ô∏è Resposta n√£o √© JSON v√°lido');
                            }
                        } else {
                            results.push(`‚ùå Erro na conex√£o: ${response.status}`);
                            results.push(`üìù Status: ${response.statusText}`);
                        }
                    } catch (error) {
                        results.push(`‚ùå Erro de conex√£o: ${error.message}`);
                        results.push('‚ÑπÔ∏è Verifique se o webhook est√° ativo no Make.com');
                    }
                }
            } else {
                results.push('‚ùå Configura√ß√£o n√£o carregada');
            }
            
            document.getElementById('testResults').innerHTML = results.map(r => `<p>${r}</p>`).join('');
        }
        
        // Testar CORS
        async function testCORS() {
            const results = [];
            
            if (typeof LANDING_PAGE_CONFIG !== 'undefined') {
                const webhookUrl = LANDING_PAGE_CONFIG.webhookUrl;
                
                results.push('üîÑ Testando CORS...');
                
                try {
                    // Teste simples de CORS
                    const response = await fetch(webhookUrl, {
                        method: 'OPTIONS',
                        headers: {
                            'Origin': window.location.origin,
                            'Access-Control-Request-Method': 'POST',
                            'Access-Control-Request-Headers': 'Content-Type'
                        }
                    });
                    
                    results.push('‚úÖ CORS preflight bem-sucedido');
                    results.push(`üìä Status: ${response.status}`);
                    
                    // Verificar headers CORS
                    const corsHeaders = {
                        'Access-Control-Allow-Origin': response.headers.get('Access-Control-Allow-Origin'),
                        'Access-Control-Allow-Methods': response.headers.get('Access-Control-Allow-Methods'),
                        'Access-Control-Allow-Headers': response.headers.get('Access-Control-Allow-Headers')
                    };
                    
                    Object.entries(corsHeaders).forEach(([header, value]) => {
                        if (value) {
                            results.push(`‚úÖ ${header}: ${value}`);
                        } else {
                            results.push(`‚ö†Ô∏è ${header}: n√£o encontrado`);
                        }
                    });
                    
                } catch (error) {
                    results.push(`‚ùå Erro CORS: ${error.message}`);
                    results.push('‚ÑπÔ∏è Isso pode indicar problemas de CORS no servidor');
                }
            } else {
                results.push('‚ùå Configura√ß√£o n√£o carregada');
            }
            
            document.getElementById('testResults').innerHTML = results.map(r => `<p>${r}</p>`).join('');
        }
        
        // Testar gera√ß√£o de post
        function testPostGeneration() {
            const results = [];
            
            // Simular gera√ß√£o de post
            const testData = {
                executiveName: 'Jo√£o Silva',
                targetSegment: 'tecnologia',
                centralTheme: 'inovacao'
            };
            
            const post = {
                title: `${testData.centralTheme} no Setor de ${testData.targetSegment}: Oportunidades e Desafios`,
                content: `üöÄ ${testData.executiveName} compartilha insights valiosos...`,
                hashtags: [`#${testData.targetSegment}`, `#${testData.centralTheme}`],
                estimatedReadingTime: '2 min',
                wordCount: 156
            };
            
            results.push('‚úÖ Post gerado com sucesso');
            results.push(`üìù T√≠tulo: ${post.title}`);
            results.push(`üìä ${post.wordCount} palavras`);
            results.push(`‚è±Ô∏è ${post.estimatedReadingTime}`);
            results.push(`üè∑Ô∏è Hashtags: ${post.hashtags.join(' ')}`);
            
            document.getElementById('testResults').innerHTML = results.map(r => `<p>${r}</p>`).join('');
        }
        
        // Executar verifica√ß√µes ao carregar
        window.onload = function() {
            checkFiles();
            checkConfig();
        };
    </script>
</body>
</html> 